
TopstepX API & WebSocket Integration Cheat Sheet
================================================

ğŸ” AUTHENTICATION (REST API)
-----------------------------
POST /api/Auth/loginKey
â†’ Login with API key
Body:
{ "userName": "your_name", "apiKey": "your_key" }
â†’ Returns: { "token": "JWT_TOKEN" }

POST /api/Auth/validate
â†’ Refresh token if expired
Returns: { "newToken": "JWT_TOKEN" }

POST /api/Auth/logout
â†’ Logs out current user

ğŸ“Š ACCOUNT & CONTRACTS (REST API)
----------------------------------
POST /api/Account/search
â†’ Gets list of accounts (returns accountId)
Body: { "onlyActiveAccounts": true }

POST /api/Contract/search
â†’ Search contracts
Body: { "searchText": "ES", "live": true }

POST /api/Contract/searchById
â†’ Get contract info by ID

ğŸ“ˆ HISTORICAL BARS (REST API)
-----------------------------
POST /api/History/retrieveBars
â†’ OHLCV data for charts
Body includes:
- contractId, startTime, endTime
- unit: 2 = minute, 3 = hour, 4 = day

ğŸ§¾ ORDERS (REST API)
---------------------
POST /api/Order/place
â†’ Place order
Body includes:
- accountId, contractId, type (1=Limit, 2=Market), side (0=Buy, 1=Sell), size

POST /api/Order/cancel
â†’ Cancel order by ID

POST /api/Order/modify
â†’ Modify active order

POST /api/Order/search
â†’ Past orders (by timestamp)

POST /api/Order/searchOpen
â†’ List of working orders

ğŸ“Œ POSITIONS (REST API)
------------------------
POST /api/Position/searchOpen
â†’ Get open positions

POST /api/Position/closeContract
â†’ Close position by contract

POST /api/Position/partialCloseContract
â†’ Close partial size

ğŸ§  TRADE HISTORY (REST API)
----------------------------
POST /api/Trade/search
â†’ Half-turn trades (realized fills)

âœ… API STATUS CHECK
-------------------
GET /api/Status/ping â†’ Returns "pong"

==============================

ğŸ”Œ REAL-TIME: SIGNALR WEBSOCKETS
==============================

ğŸ‘¤ USER HUB (wss://rtc.topstepx.com/hubs/user?access_token=JWT)
--------------------------------------------------------------
Subscribe calls:
- SubscribeAccounts()
- SubscribeOrders(accountId)
- SubscribePositions(accountId)
- SubscribeTrades(accountId)

Handlers:
- GatewayUserAccount â†’ balance updates
- GatewayUserOrder â†’ order state updates
- GatewayUserPosition â†’ size/avgPrice
- GatewayUserTrade â†’ trade fills

ğŸ“ˆ MARKET HUB (wss://rtc.topstepx.com/hubs/market?access_token=JWT)
------------------------------------------------------------------
Subscribe calls:
- SubscribeContractQuotes(contractId)
- SubscribeContractTrades(contractId)
- SubscribeContractMarketDepth(contractId)

Handlers:
- GatewayQuote â†’ top of book (L1)
- GatewayTrade â†’ time & sales
- GatewayDepth â†’ market depth (L2)

Notes:
- Use .onreconnected() to re-subscribe on reconnect
- contractId examples: "CON.F.US.EP.M25"
- JWT token required for access
